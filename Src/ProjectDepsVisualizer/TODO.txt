TODO IMM HI: Review and generalize. Remove this file after it's done.
